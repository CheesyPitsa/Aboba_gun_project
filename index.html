<!DOCTYPE html>
<html lang="ru" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>ABOBA Gun Detection</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
<!--    <style>-->

<!--        *{-->
<!--    margin: 0;-->
<!--    padding: 0;-->
<!--    box-sizing: border-box;-->
<!--}-->

<!--.header{-->
<!--    position: absolute; /* задаем шапке фиксированное позиционирование */-->
<!--    top: 50px; /* располагаем шапку в верхней части окна браузера */-->
<!--    left: 0; /* располагаем шапку в левой части окна браузера */-->
<!--    width: 100%; /* задаем ширину шапки на всю ширину окна браузера */-->
<!--    display: flex; /* задаем элементам шапки flex-контейнер */-->
<!--    justify-content: center; /* выравниваем элементы шапки по центру */-->
<!--    align-items: center; /* выравниваем элементы шапки по вертикали */-->
<!--}-->
<!--.input__file-button {-->
<!--  width: 100%;-->
<!--  max-width: 290px;-->
<!--  height: 60px;-->
<!--  background: #1bbc9b;-->
<!--  color: #fff;-->
<!--  font-size: 1.125rem;-->
<!--  font-weight: 700;-->
<!--  display: -webkit-box;-->
<!--  display: -ms-flexbox;-->
<!--  display: flex;-->
<!--  -webkit-box-align: center;-->
<!--      -ms-flex-align: center;-->
<!--          align-items: center;-->
<!--  -webkit-box-pack: start;-->
<!--      -ms-flex-pack: start;-->
<!--          justify-content: flex-start;-->
<!--  border-radius: 3px;-->
<!--  cursor: pointer;-->
<!--  margin: 0 auto;-->
<!--}-->

<!--.logo{-->
<!--    position: absolute;-->
<!--    top: 20px; /* располагаем логотип в верхней части родительского элемента */-->
<!--    right: 50px;-->
<!--}-->


<!--.nav{-->
<!--    position: absolute;-->
<!--    top: 20px;-->
<!--    display: inline;-->
<!--    display: flex; /* задаем элементам навигации flex-контейнер */-->
<!--    justify-content: center; /* выравниваем элементы навигации по краям контейнера */-->
<!--    align-items: center; /* выравниваем элементы навигации по вертикали */-->
<!--    height: 50px; /* задаем высоту навигации */-->
<!--    padding: 0 20px;-->
<!--}-->

<!--.input__file {-->
<!--  opacity: 0;-->
<!--  visibility: hidden;-->
<!--  position: absolute;-->
<!--}-->

<!--a:-webkit-any-link {-->
<!--    color: white;-->
<!--    cursor: pointer;-->
<!--    text-decoration: transparent;-->
<!--    margin-right: 100px;-->
<!--    text-transform: uppercase;-->
<!--    font-family: Montserrat;-->
<!--    font-size: 30px;-->
<!--    font-style: normal;-->
<!--    font-weight: 500;-->
<!--    line-height: normal;-->
<!--    letter-spacing: -0.15px;-->
<!--}-->


<!--body{-->
<!--    background-image: url(/img/title.png);-->
<!--    background-position: center center;-->
<!--    background-size: cover;-->
<!--    background-repeat: no-repeat;-->
<!--    background-attachment: fixed;-->

<!--    background-color: #000;-->
<!--}-->


<!--.container {-->
<!--    height: 1080px; /* задаем высоту контейнера */-->
<!--  }-->

<!--  .curtain {-->
<!--    float: left; /* выравниваем элементы по левому краю */-->
<!--    width: 3%;-->
<!--    height: 100%;-->
<!--    flex-shrink: 0;-->
<!--    background: linear-gradient(90deg, rgba(0, 0, 0, 0.40) 0%, rgba(0, 0, 0, 0.40) 0.01%, rgba(255, 255, 255, 0.16) 24.37%, rgba(255, 255, 255, 0.02) 56.15%, rgba(0, 0, 0, 0.40) 100%);-->
<!--    mix-blend-mode: overlay;-->
<!--    backdrop-filter: blur(20px);-->
<!--    margin-right: 0px; /* задаем отступ между элементами */-->
<!--  }-->

<!--  .curtain:last-child {-->
<!--    margin-right: 0; /* убираем отступ у последнего элемента */-->
<!--  }-->

<!--  .curtain::after {-->
<!--    content: "";-->
<!--    display: table;-->
<!--    clear: both;-->
<!--  }-->



<!--  .text{-->
<!--    position: absolute;-->
<!--    top: 40%;-->
<!--    left: 0;-->
<!--    right: 0;-->
<!--    color: white;-->
<!--    text-align: center;-->
<!--    text-transform: uppercase;-->
<!--    font-family: Montserrat;-->
<!--    font-size: 130px;-->
<!--    font-style: normal;-->
<!--    font-weight: 500;-->

<!--  }-->

<!--  .ai{-->
<!--    position: absolute;-->
<!--    top: 57%;-->
<!--    left: 50%;-->
<!--    padding: 27.5px 29.952px 27.5px 31.048px;-->
<!--    justify-content: center;-->
<!--    align-items: center;-->

<!--    border-radius: 20px;-->
<!--    background: rgba(10, 10, 10, 0.70);-->
<!--    backdrop-filter: blur(10.5px);-->
<!--  }-->

<!--  .text-ai{-->

<!--        color: #FFF;-->
<!--        font-family: Montserrat;-->
<!--        font-size: 30px;-->
<!--        font-style: normal;-->
<!--        font-weight: 400;-->
<!--        line-height: normal;-->
<!--        letter-spacing: -0.15px;-->
<!--        text-transform: lowercase;-->
<!--  }-->

<!--  .button{-->
<!--    position: absolute;-->
<!--    top: 75%;-->
<!--    left: 40%;-->
<!--    padding: 26px 141px;-->
<!--    justify-content: center;-->
<!--    align-items: center;-->
<!--    cursor: pointer;-->

<!--    border-radius: 20px;-->
<!--    border: 2px solid #FFF;-->
<!--    background: #0A0A0A;-->
<!--    backdrop-filter: blur(10.5px);-->

<!--  }-->

<!--  .start{-->
<!--    color: #FFF;-->
<!--    font-family: Montserrat;-->
<!--    font-size: 35px;-->
<!--    font-style: normal;-->
<!--    font-weight: 600;-->
<!--    line-height: normal;-->
<!--    letter-spacing: -0.25px;-->
<!--    text-transform: uppercase;-->
<!--  }-->
<!--    </style>-->

</head>

<body>

    <div>
       <input name="uploadInput" type="file" id="uploadInput" class="input input__file">
       <label for="uploadInput" class="start">
          <span class="button">Start</span>
       </label>
    </div>
<!--    <input id="uploadInput" type="file" accept=".jpg,.jpeg,.png"/>-->
    <canvas></canvas>

    <header class="header">
        <div class="logo">
            <img src="/img/logo.png" alt="">
        </div>
        <nav class="nav">
          <ul class="menu">
            <a href="https://github.com/CheesyPitsa/Aboba_gun_project">Our GitHub</a></li>
          </ul>
        </nav>
      </header>

    <div class="container">
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
    <div class="curtain"></div>
</div>

<div class="nitro">
    <p class="text">Team Aboba</p>

</div>

<div class="ai">
    <p class="text-ai">Нейросеть, распознающая образ оружия</p>
</div>

<!--<button class="button" id="uploadInput" type="file" accept=".jpg,.jpeg,.png">-->
<!--    <p class="start">start</p>-->
<!--</button>-->


    <script>
 const input = document.getElementById("uploadInput");
 input.addEventListener("change",async(event) => {
     const data = new FormData();
     data.append("image_file",event.target.files[0],"image_file");
     const response = await fetch("/detect",{method:"post",body:data});
     const boxes = await response.json();
     draw_image_and_boxes(event.target.files[0],boxes);})

function draw_image_and_boxes(file,boxes) {
    const img = new Image()
    img.src = URL.createObjectURL(file);
    img.onload = () => {
        const canvas = document.querySelector("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img,0,0);
        ctx.strokeStyle = "#00FF00";
        ctx.lineWidth = 3;
        ctx.font = "18px serif";
        boxes.forEach(([x1,y1,x2,y2,label]) => {
            ctx.strokeRect(x1,y1,x2-x1,y2-y1);
            ctx.fillStyle = "#00ff00";
            const width = ctx.measureText(label).width;
            ctx.fillRect(x1,y1,width+10,25);
            ctx.fillStyle = "#000000";
            ctx.fillText(label, x1, y1+18);});}}
</script>
</body>
</html>